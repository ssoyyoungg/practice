<2026.02.20>
< Counfusion Matric >
    
              실제positive  실제Negative
예측 Positive  TP           FP
예측 Negative  FN           TN

TP : 실제 양성인데 양성으로 예측한 경우
FP : 실제 음성인데 양성으로 예측한 경우
FN : 실제 양성인데 음성으로 예측한 경우
TN : 실제 음성인데 음성으로 예측한 경우

Precision(정밀도) 
: 모델이 양성이라고 예측한 것 중 실제 양성인 경우
공식 : TP / TP+FP
=> 오진을 줄이는데 중요

Recall(재현율, 민감도 = Sensitivity) 
: 실제 양성 중에서 모델이 맞춘 비율
공식 : TP / TP+FN

F1 Score 
: Precision과 Recall의 조화평균
공식 : 2 x [precision x Recall / precision + Recall]
=> 평균이 아니라 조화평균을 사용하는 이유 : Precision과 Recall 둘 중 하나라도 
    낮으면 F1도 크게 떨어지기 때문
    0과 1사이 값으로 나오고 1에 가까울수록 성능이 좋음을 나타냄

의료산업에서 Accuracy 보다 Recall/F1 score 더 많이 사용하는 이유 :
정상이 더 많이 나오는 결과라면 자동적으로 Accuracy는 올라가지만 
모두 정상이라고 예측하면 환자의 정확한 진단이 어려움


< Precision / Recall / F1 score 출력 >

              precision    recall  f1-score   support

           0       0.97      0.98      0.98      4000
           1       0.99      0.98      0.99      6000

    accuracy                           0.98     10000
   macro avg       0.98      0.98      0.98     10000
weighted avg       0.98      0.98      0.98     10000


Precision, Recall, F1-score 모두 0.98 이상을 기록함.
특히 양성 클래스에 대한 Recall이 0.98로 높게 유지되어, 
민감도 중심 평가 구조를 구현하였음을 확인함.


< ROC Curve & AUC >

Threshold : 양성으로 판단하는 기준 확률
            높일경우 : Recall 올라감, Precision 내려감
            낮출경우 : Recall 내려감, precision 올라감
            => 목적에 맞게 조절해야함

- ROC Curve :  임계치를 바꿔가며 모델의 성능을 보는 그래프
X축 : FPR(False Positive Rate) : 실제 양성중 양성으로 잘못 예측한 비율
Y축 : TPR(True Positive Rate = Recall)
왼쪽 위에 가까울수록 좋음
대각선이면 랜덤 모델

- AUC : ROC 곡선 아래 면적
무작위로 양성과 음성 하나씩 뽑았을 때 모델이 양성을 더 높은 점수로 줄 확률
0.5 : 랜덤 / 0.7 : 보통 / 0.8 : 좋음 / 0.9이상 : 매우 좋음 / 1.0 : 완벽

Accuracy랑 다른점 : 
Accuracy 는 threshold 1개 기준
ROC는 모든 threshold에서의 성능을 통합 평가

Binary classification 실험에서 ROC-AUC는 0.98을 기록함.
이는 다양한 threshold 설정에서도 모델이 높은 민감도와 
낮은 위양성률을 유지함을 의미하며, 분류 경계의 안정성이 확보되었음을 보여줌.

< False Negative >
실제로는 양성인데 음성으로 오분류 한것 

< False Positive >
실제로는 음성인데 양성으로 오분류 한 것

< 새로운 Threshold를 이용한 실험 >

Sensitivity 0.99이상이 되는 Threshold를 찾은 결과 threshold: 0.26835078의 결과 값을
얻게 됨
Threshold를 기본값(0.5)에서 0.2683으로 낮추어 재평가한 결과,
False Negative(FN)는 103건에서 60건으로 감소함.
고로 animal 클래스에 대한 민감도(Sensitivity)가 향상되었음을 의미함.
반면, False Positive(FP)는 71건에서 118건으로 증가함.
이는 threshold 하향 조정으로 인해 vehicle 클래스 일부가 animal로 과검출되었음이 확인됨.
해당 실험은 분류 모델에서 threshold 조정 시
민감도와 특이도 간 trade-off가 존재함을 보여준다.
의료 AI 환경에서는 FN 감소가 더욱 중요할 수 있으므로,
임상 목적에 따라 적절한 threshold 선택이 필요한 것을 확인함.


